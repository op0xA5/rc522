package rc522

func ISO14443aCRC(dat []byte) uint16 {
	crc := uint16(0x6363)
	for _, ch := range dat {
		pos := int(crc >> 8) ^ int(ch)
		crc = (crc << 8) ^ crcTable[pos]
	}
	return crc
}

func AppendISO14443aCRC(dst, dat []byte) []byte {
	crc := ISO14443aCRC(dat)
	buf := [2]byte{uint8(crc >> 8), uint8(crc)}
	return append(dst, buf[:]...)
}

var crcTable = []uint16{
	0x0000, 0x8911, 0x1223, 0x9B32, 0x2446, 0xAD57, 0x3665, 0xBF74, 0x488C, 0xC19D, 0x5AAF, 0xD3BE, 0x6CCA, 0xE5DB, 0x7EE9, 0xF7F8,
	0x8110, 0x0801, 0x9333, 0x1A22, 0xA556, 0x2C47, 0xB775, 0x3E64, 0xC99C, 0x408D, 0xDBBF, 0x52AE, 0xEDDA, 0x64CB, 0xFFF9, 0x76E8,
	0x0221, 0x8B30, 0x1002, 0x9913, 0x2667, 0xAF76, 0x3444, 0xBD55, 0x4AAD, 0xC3BC, 0x588E, 0xD19F, 0x6EEB, 0xE7FA, 0x7CC8, 0xF5D9,
	0x8331, 0x0A20, 0x9112, 0x1803, 0xA777, 0x2E66, 0xB554, 0x3C45, 0xCBBD, 0x42AC, 0xD99E, 0x508F, 0xEFFB, 0x66EA, 0xFDD8, 0x74C9,
	0x0442, 0x8D53, 0x1661, 0x9F70, 0x2004, 0xA915, 0x3227, 0xBB36, 0x4CCE, 0xC5DF, 0x5EED, 0xD7FC, 0x6888, 0xE199, 0x7AAB, 0xF3BA,
	0x8552, 0x0C43, 0x9771, 0x1E60, 0xA114, 0x2805, 0xB337, 0x3A26, 0xCDDE, 0x44CF, 0xDFFD, 0x56EC, 0xE998, 0x6089, 0xFBBB, 0x72AA,
	0x0663, 0x8F72, 0x1440, 0x9D51, 0x2225, 0xAB34, 0x3006, 0xB917, 0x4EEF, 0xC7FE, 0x5CCC, 0xD5DD, 0x6AA9, 0xE3B8, 0x788A, 0xF19B,
	0x8773, 0x0E62, 0x9550, 0x1C41, 0xA335, 0x2A24, 0xB116, 0x3807, 0xCFFF, 0x46EE, 0xDDDC, 0x54CD, 0xEBB9, 0x62A8, 0xF99A, 0x708B,
	0x0884, 0x8195, 0x1AA7, 0x93B6, 0x2CC2, 0xA5D3, 0x3EE1, 0xB7F0, 0x4008, 0xC919, 0x522B, 0xDB3A, 0x644E, 0xED5F, 0x766D, 0xFF7C,
	0x8994, 0x0085, 0x9BB7, 0x12A6, 0xADD2, 0x24C3, 0xBFF1, 0x36E0, 0xC118, 0x4809, 0xD33B, 0x5A2A, 0xE55E, 0x6C4F, 0xF77D, 0x7E6C,
	0x0AA5, 0x83B4, 0x1886, 0x9197, 0x2EE3, 0xA7F2, 0x3CC0, 0xB5D1, 0x4229, 0xCB38, 0x500A, 0xD91B, 0x666F, 0xEF7E, 0x744C, 0xFD5D,
	0x8BB5, 0x02A4, 0x9996, 0x1087, 0xAFF3, 0x26E2, 0xBDD0, 0x34C1, 0xC339, 0x4A28, 0xD11A, 0x580B, 0xE77F, 0x6E6E, 0xF55C, 0x7C4D,
	0x0CC6, 0x85D7, 0x1EE5, 0x97F4, 0x2880, 0xA191, 0x3AA3, 0xB3B2, 0x444A, 0xCD5B, 0x5669, 0xDF78, 0x600C, 0xE91D, 0x722F, 0xFB3E,
	0x8DD6, 0x04C7, 0x9FF5, 0x16E4, 0xA990, 0x2081, 0xBBB3, 0x32A2, 0xC55A, 0x4C4B, 0xD779, 0x5E68, 0xE11C, 0x680D, 0xF33F, 0x7A2E,
	0x0EE7, 0x87F6, 0x1CC4, 0x95D5, 0x2AA1, 0xA3B0, 0x3882, 0xB193, 0x466B, 0xCF7A, 0x5448, 0xDD59, 0x622D, 0xEB3C, 0x700E, 0xF91F,
	0x8FF7, 0x06E6, 0x9DD4, 0x14C5, 0xABB1, 0x22A0, 0xB992, 0x3083, 0xC77B, 0x4E6A, 0xD558, 0x5C49, 0xE33D, 0x6A2C, 0xF11E, 0x780F,
}
